{"version":3,"sources":["datatypes/minecraft.js"],"names":[],"mappings":"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","file":"datatypes/minecraft.js","sourcesContent":["var nbt = require('prismarine-nbt');\nvar utils = require(\"./utils\");\nvar numeric = require(\"./numeric\");\n\n// TODO : remove type-specific, replace with generic containers and arrays.\nmodule.exports = {\n  'UUID': [readUUID, writeUUID, 16],\n  'position': [readPosition, writePosition, 8],\n  'slot': [readSlot, writeSlot, sizeOfSlot],\n  'nbt': [readNbt, utils.buffer[1], utils.buffer[2]],\n  'restBuffer': [readRestBuffer, utils.buffer[1], utils.buffer[2]],\n  'entityMetadata': [readEntityMetadata, writeEntityMetadata, sizeOfEntityMetadata]\n};\n\nfunction readUUID(buffer, offset) {\n  return {\n    value: [\n      buffer.readUInt32BE(offset),\n      buffer.readUInt32BE(offset + 4),\n      buffer.readUInt32BE(offset + 8),\n      buffer.readUInt32BE(offset + 12),\n    ],\n    size: 16,\n  };\n}\n\nfunction writeUUID(value, buffer, offset) {\n  buffer.writeUInt32BE(value[0], offset);\n  buffer.writeUInt32BE(value[1], offset + 4);\n  buffer.writeUInt32BE(value[2], offset + 8);\n  buffer.writeUInt32BE(value[3], offset + 12);\n  return offset + 16;\n}\n\n\nfunction readPosition(buffer, offset) {\n  var longVal = numeric.long[0](buffer, offset).value;\n  var x = signExtend26(longVal[0] >> 6);\n  var y = signExtend12(((longVal[0] & 0x3f) << 6) | ((longVal[1] >> 26) & 0x3f));\n  var z = signExtend26(longVal[1] & 0x3FFFFFF);\n  return {\n    value: {x: x, y: y, z: z},\n    size: 8\n  };\n}\nfunction signExtend26(value) {\n  if(value > 0x2000000) value -= 0x4000000;\n  return value;\n}\nfunction signExtend12(value) {\n  if(value > 0x800) value -= 0x1000;\n  return value;\n}\n\n\nfunction writePosition(value, buffer, offset) {\n  var longVal = [];\n  longVal[0] = ((value.x & 0x3FFFFFF) << 6) | ((value.y & 0xFFF) >> 6);\n  longVal[1] = ((value.y & 0x3F) << 26) | (value.z & 0x3FFFFFF);\n  return numeric.long[1](longVal, buffer, offset);\n}\n\n\nfunction readSlot(buffer, offset) {\n  var value = {};\n  var results = numeric.short[0](buffer, offset);\n  if(!results) return null;\n  value.blockId = results.value;\n\n  if(value.blockId === -1) {\n    return {\n      value: value,\n      size: 2,\n    };\n  }\n\n  var cursorEnd = offset + 6;\n  if(cursorEnd > buffer.length) return null;\n  value.itemCount = buffer.readInt8(offset + 2);\n  value.itemDamage = buffer.readInt16BE(offset + 3);\n  var nbtData = buffer.readInt8(offset + 5);\n  if(nbtData == 0) {\n    return {\n      value: value,\n      size: 6\n    }\n  }\n  var nbtData = readNbt(buffer, offset + 5);\n  value.nbtData = nbtData.value;\n  return {\n    value: value,\n    size: nbtData.size + 5\n  };\n}\n\nfunction writeSlot(value, buffer, offset) {\n  buffer.writeInt16BE(value.blockId, offset);\n  if(value.blockId === -1) return offset + 2;\n  buffer.writeInt8(value.itemCount, offset + 2);\n  buffer.writeInt16BE(value.itemDamage, offset + 3);\n  var nbtDataLen;\n  if(value.nbtData) {\n    var newbuf = nbt.writeUncompressed(value.nbtData);\n    newbuf.copy(buffer, offset + 5);\n    nbtDataLen = newbuf.length;\n  }\n  else {\n    buffer.writeInt8(0, offset + 5);\n    nbtDataLen = 1;\n  }\n  return offset + 5 + nbtDataLen;\n}\n\nfunction sizeOfSlot(value) {\n  if(value.blockId === -1)\n    return (2);\n  else if(!value.nbtData) {\n    return (6);\n  } else {\n    return (5 + sizeOfNbt(value.nbtData));\n  }\n}\n\n\nfunction readNbt(buffer, offset) {\n  buffer = buffer.slice(offset);\n  return nbt.parseUncompressed(buffer);\n}\n\nfunction writeNbt(value, buffer, offset) {\n  var newbuf = nbt.writeUncompressed(value);\n  newbuf.copy(buffer, offset);\n  return offset + newbuf.length;\n}\n\nfunction sizeOfNbt(value) {\n  return nbt.writeUncompressed(value).length;\n}\n\n\nfunction readRestBuffer(buffer, offset, typeArgs, rootNode) {\n  return {\n    value: buffer.slice(offset),\n    size: buffer.length - offset\n  };\n}\n\n\nvar entityMetadataTypes = {\n  0: {type: 'byte'},\n  1: {type: 'short'},\n  2: {type: 'int'},\n  3: {type: 'float'},\n  4: {type: 'string'},\n  5: {type: 'slot'},\n  6: {\n    type: 'container', typeArgs: {\n      fields: [\n        {name: 'x', type: 'int'},\n        {name: 'y', type: 'int'},\n        {name: 'z', type: 'int'}\n      ]\n    }\n  },\n  7: {\n    type: 'container', typeArgs: {\n      fields: [\n        {name: 'pitch', type: 'float'},\n        {name: 'yaw', type: 'float'},\n        {name: 'roll', type: 'float'}\n      ]\n    }\n  }\n};\n\n// maps string type name to number\nvar entityMetadataTypeBytes = {};\nfor(var n in entityMetadataTypes) {\n  if(!entityMetadataTypes.hasOwnProperty(n)) continue;\n\n  entityMetadataTypeBytes[entityMetadataTypes[n].type] = n;\n}\n\n\nfunction readEntityMetadata(buffer, offset) {\n  var cursor = offset;\n  var metadata = [];\n  var item, key, type, results, reader, typeName, dataType;\n  while(true) {\n    if(cursor + 1 > buffer.length) return null;\n    item = buffer.readUInt8(cursor);\n    cursor += 1;\n    if(item === 0x7f) {\n      return {\n        value: metadata,\n        size: cursor - offset,\n      };\n    }\n    key = item & 0x1f;\n    type = item >> 5;\n    dataType = entityMetadataTypes[type];\n    typeName = dataType.type;\n    //debug(\"Reading entity metadata type \" + dataType + \" (\" + ( typeName || \"unknown\" ) + \")\");\n    if(!dataType) {\n      return {\n        error: new Error(\"unrecognized entity metadata type \" + type)\n      }\n    }\n    results = this.read(buffer, cursor, dataType, {});\n    if(!results) return null;\n    metadata.push({\n      key: key,\n      value: results.value,\n      type: typeName,\n    });\n    cursor += results.size;\n  }\n}\n\n\nfunction writeEntityMetadata(value, buffer, offset) {\n  var self = this;\n  value.forEach(function(item) {\n    var type = entityMetadataTypeBytes[item.type];\n    var headerByte = (type << 5) | item.key;\n    buffer.writeUInt8(headerByte, offset);\n    offset += 1;\n    offset = self.write(item.value, buffer, offset, entityMetadataTypes[type], {});\n  });\n  buffer.writeUInt8(0x7f, offset);\n  return offset + 1;\n}\n\n\nfunction sizeOfEntityMetadata(value) {\n  var size = 1 + value.length;\n  var item;\n  for(var i = 0; i < value.length; ++i) {\n    item = value[i];\n    size += this.sizeOf(item.value, entityMetadataTypes[entityMetadataTypeBytes[item.type]], {});\n  }\n  return size;\n}\n"],"sourceRoot":"/source/"}