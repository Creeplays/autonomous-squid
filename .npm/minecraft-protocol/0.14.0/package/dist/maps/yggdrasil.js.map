{"version":3,"sources":["yggdrasil.js"],"names":[],"mappings":"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","file":"yggdrasil.js","sourcesContent":["/*\n * To change this template, choose Tools | Templates\n * and open the template in the editor.\n */\nvar superagent = require(\"superagent\");\n\nvar loginSrv = \"https://authserver.mojang.com\";\n\nfunction getSession(username, password, clientToken, refresh, cb) {\n  if(refresh) {\n    var accessToken = password;\n    superagent.post(loginSrv + \"/refresh\")\n      .type(\"json\")\n      .send({\n        \"accessToken\": accessToken,\n        \"clientToken\": clientToken\n      })\n      .end(function(resp) {\n        if(resp.ok) {\n          var session = {\n            accessToken: resp.body.accessToken,\n            clientToken: resp.body.clientToken,\n            username: resp.body.selectedProfile.name,\n            selectedProfile: resp.body.selectedProfile\n          };\n          cb(null, session);\n        } else {\n          var myErr = new Error(resp.body.error);\n          myErr.errorMessage = resp.body.errorMessage;\n          myErr.cause = resp.body.cause;\n          cb(myErr);\n        }\n      });\n  } else {\n    superagent.post(loginSrv + \"/authenticate\")\n      .type(\"json\")\n      .send({\n        \"agent\": {\n          \"name\": \"Minecraft\",\n          \"version\": 1\n        },\n        \"username\": username,\n        \"password\": password,\n        \"clientToken\": clientToken\n      })\n      .end(function(resp) {\n        if(resp.ok) {\n          var session = resp.body;\n          session.username = resp.body.selectedProfile.name;\n          cb(null, session);\n        } else {\n          var myErr = new Error(resp.body.error);\n          myErr.errorMessage = resp.body.errorMessage;\n          myErr.cause = resp.body.cause;\n          cb(myErr);\n        }\n      });\n  }\n}\n\nfunction joinServer(username, serverId, accessToken, selectedProfile, cb) {\n  superagent.post(\"https://sessionserver.mojang.com/session/minecraft/join\")\n    .type(\"json\")\n    .send({\n      \"accessToken\": accessToken,\n      \"selectedProfile\": selectedProfile,\n      \"serverId\": serverId\n    })\n    .end(function(resp) {\n      if(resp.ok) {\n        cb(null);\n      } else {\n        var myErr = new Error(resp.body.error);\n        myErr.errorMessage = resp.body.errorMessage;\n        myErr.cause = resp.body.cause;\n        cb(myErr);\n      }\n    });\n}\n\nfunction validateSession(username, serverId, cb) {\n  superagent.get(\"https://sessionserver.mojang.com/session/minecraft/hasJoined?username=\" + username + \"&serverId=\" + serverId)\n    .end(function(resp) {\n      if(resp.ok) {\n        if(\"id\" in resp.body) {\n          cb(null, resp.body.id);\n        } else {\n          var myErr = new Error(\"Failed to verify username!\");\n          cb(myErr);\n        }\n      } else {\n        var myErr = new Error(resp.body.error);\n        myErr.errorMessage = resp.body.errorMessage;\n        myErr.cause = resp.body.cause;\n        cb(myErr);\n      }\n    });\n}\n\nexports.getSession = getSession;\nexports.joinServer = joinServer;\nexports.validateSession = validateSession;\nexports.generateUUID = require(\"node-uuid\").v4;\nexports.loginType = \"yggdrasil\";\n"],"sourceRoot":"/source/"}